# IronForge V2 - æ•°æ®åˆ†ç¦»æ¨¡å‹

> ğŸ“… åˆ›å»ºæ—¥æœŸ: 2025-11-25  
> ğŸ”’ ç‰ˆæœ¬: 2.0  
> ğŸ¯ æ¶æ„: éæ‰˜ç®¡é’±åŒ… + ä¼ä¸šçº§ API

---

## ğŸ“‹ ç›®å½•

- [æ ¸å¿ƒç†å¿µ](#æ ¸å¿ƒç†å¿µ)
- [æ•°æ®åˆ†ç±»](#æ•°æ®åˆ†ç±»)
- [å‰ç«¯æ•°æ®å­˜å‚¨](#å‰ç«¯æ•°æ®å­˜å‚¨)
- [åç«¯æ•°æ®å­˜å‚¨](#åç«¯æ•°æ®å­˜å‚¨)
- [æ•°æ®æµè®¾è®¡](#æ•°æ®æµè®¾è®¡)
- [å®‰å…¨ä¿è¯](#å®‰å…¨ä¿è¯)

---

## ğŸ¯ æ ¸å¿ƒç†å¿µ

### éæ‰˜ç®¡ + ä¼ä¸š API æ··åˆæ¨¡å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è®¾è®¡å“²å­¦                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ç§é’¥ç”¨æˆ·æŒæ§ - å‰ç«¯åŠ å¯†å­˜å‚¨ï¼Œåç«¯æ°¸ä¸æ¥è§¦               â”‚
â”‚ 2. å…ƒæ•°æ®äº‘ç«¯ç®¡ç† - æä¾›ä¼ä¸šçº§æŸ¥è¯¢ã€ç»Ÿè®¡ã€åˆ†ææœåŠ¡         â”‚
â”‚ 3. å¯æ¢å¤æ€§å¹³è¡¡ - åç«¯æ•°æ®ä¸¢å¤±å¯æ¢å¤ï¼Œç§é’¥ä¸¢å¤±æ°¸ä¹…æ— æ³•æ‰¾å› â”‚
â”‚ 4. é›¶ä¿¡ä»»æ¶æ„ - å‡è®¾åç«¯å¯èƒ½è¢«æ”»ç ´ï¼Œç§é’¥ä»ç„¶å®‰å…¨           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸ºä»€ä¹ˆéœ€è¦åç«¯ï¼Ÿ

è™½ç„¶æ˜¯éæ‰˜ç®¡é’±åŒ…ï¼Œä½†åç«¯æä¾›ä»¥ä¸‹**å¢å€¼æœåŠ¡**ï¼š

1. **å¤šè®¾å¤‡åŒæ­¥** - é’±åŒ…åˆ—è¡¨ã€é…ç½®åœ¨å¤šè®¾å¤‡é—´åŒæ­¥
2. **äº¤æ˜“å†å²** - èšåˆæŸ¥è¯¢æ‰€æœ‰é“¾çš„å†å²è®°å½•
3. **ç»Ÿè®¡åˆ†æ** - èµ„äº§åˆ†å¸ƒã€äº¤æ˜“è¶‹åŠ¿ã€æ”¶ç›Šç»Ÿè®¡
4. **é€šçŸ¥æœåŠ¡** - äº¤æ˜“åˆ°è´¦æé†’ã€ä»·æ ¼é¢„è­¦
5. **å®¡è®¡åˆè§„** - æ»¡è¶³ä¼ä¸šå®¡è®¡å’Œç›‘ç®¡è¦æ±‚
6. **å¤‡ä»½æ¢å¤** - å…ƒæ•°æ®å¤‡ä»½ï¼ˆä¸å«ç§é’¥ï¼‰

---

## ğŸ“Š æ•°æ®åˆ†ç±»

### æŒ‰æ•æ„Ÿç¨‹åº¦åˆ†ç±»

| çº§åˆ« | æ•°æ®ç±»å‹ | å­˜å‚¨ä½ç½® | åŠ å¯†æ–¹å¼ | ç¤ºä¾‹ |
|------|---------|---------|---------|------|
| **ğŸ”´ ç»å¯†** | ç§é’¥ã€åŠ©è®°è¯ | å‰ç«¯ IndexedDB | AES-256-GCM | `mnemonic`, `private_key` |
| **ğŸŸ  æ•æ„Ÿ** | ç”¨æˆ·å¯†ç  | å‰ç«¯ + åç«¯ | Argon2id å“ˆå¸Œ | `password_hash` |
| **ğŸŸ¡ æœºå¯†** | ä¼šè¯ Token | å‰ç«¯ + åç«¯ç¼“å­˜ | JWT ç­¾å | `access_token` |
| **ğŸŸ¢ å†…éƒ¨** | é’±åŒ…å…ƒæ•°æ® | åç«¯æ•°æ®åº“ | TLS ä¼ è¾“ | `wallet_name`, `address` |
| **âšª å…¬å¼€** | äº¤æ˜“å“ˆå¸Œ | åç«¯ + é“¾ä¸Š | æ— éœ€åŠ å¯† | `tx_hash` |

### æŒ‰å¯æ¢å¤æ€§åˆ†ç±»

| æ•°æ®ç±»å‹ | ä¸¢å¤±åæœ | æ¢å¤æ–¹å¼ |
|---------|---------|---------|
| **ç§é’¥/åŠ©è®°è¯** | âŒ æ°¸ä¹…æ— æ³•æ‰¾å›èµ„äº§ | æ— æ³•æ¢å¤ï¼ˆç”¨æˆ·è´£ä»»ï¼‰ |
| **ç”¨æˆ·å¯†ç ** | âš ï¸ æ— æ³•è§£é”æœ¬åœ°é’±åŒ… | å¯é€šè¿‡åŠ©è®°è¯é‡æ–°å¯¼å…¥ |
| **é’±åŒ…å…ƒæ•°æ®** | âœ… åªéœ€é‡æ–°æ·»åŠ é’±åŒ… | åç«¯æ•°æ®åº“å¤‡ä»½ |
| **äº¤æ˜“å†å²** | âœ… ä¸å½±å“èµ„äº§å®‰å…¨ | åŒºå—é“¾æµè§ˆå™¨æŸ¥è¯¢ |
| **ä¼šè¯ Token** | âœ… é‡æ–°ç™»å½•å³å¯ | é‡æ–°è®¤è¯ |

---

## ğŸ’» å‰ç«¯æ•°æ®å­˜å‚¨

### å­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | å®¹é‡ | æ€§èƒ½ | å®‰å…¨æ€§ | ç”¨é€” |
|------|------|------|--------|------|
| **IndexedDB** | ~50MB+ | é«˜ | ä¸­ (éœ€åŠ å¯†) | ğŸ”‘ ç§é’¥ã€åŠ©è®°è¯ |
| **LocalStorage** | ~5MB | ä¸­ | ä½ | âš™ï¸ é…ç½®ã€ç¼“å­˜ |
| **SessionStorage** | ~5MB | ä¸­ | ä½ | ğŸ”„ ä¸´æ—¶ä¼šè¯ |
| **Memory (Signal)** | æ— é™ | æé«˜ | é«˜ | ğŸ§  è¿è¡Œæ—¶çŠ¶æ€ |

### IndexedDB æ•°æ®ç»“æ„

```typescript
// æ•°æ®åº“åç§°
const DB_NAME = "ironforge_wallet";
const DB_VERSION = 1;

// Object Stores (è¡¨)
interface WalletStore {
  id: string;                    // UUID
  name: string;                  // é’±åŒ…åç§°
  encrypted_mnemonic: string;    // ğŸ”’ AES-256-GCM åŠ å¯†çš„åŠ©è®°è¯
  password_hash: string;         // Argon2id å“ˆå¸Œ
  created_at: number;            // æ—¶é—´æˆ³
  updated_at: number;
  
  // æ´¾ç”Ÿçš„åœ°å€ï¼ˆæ˜æ–‡ï¼Œå…¬å¼€æ•°æ®ï¼‰
  addresses: {
    chain: string;               // "ethereum", "bitcoin", "ton"
    address: string;             // å…¬å¼€åœ°å€
    derivation_path: string;     // "m/44'/60'/0'/0/0"
  }[];
  
  // æœ¬åœ°é…ç½®
  settings: {
    auto_lock_minutes: number;
    default_chain: string;
    currency: string;            // "USD", "CNY"
  };
}

// åŠ å¯†å¯†é’¥æ´¾ç”Ÿ
interface KeyDerivationParams {
  salt: Uint8Array;              // 32 å­—èŠ‚éšæœºç›
  iterations: number;            // Argon2 è¿­ä»£æ¬¡æ•°
  memory: number;                // å†…å­˜æ¶ˆè€— (KB)
  parallelism: number;           // å¹¶è¡Œåº¦
}
```

### åŠ å¯†æµç¨‹

```rust
// src/infrastructure/crypto/encryption.rs

use aes_gcm::{Aes256Gcm, Key, Nonce};
use argon2::{Argon2, PasswordHasher};
use rand::RngCore;

pub struct WalletEncryption;

impl WalletEncryption {
    /// ç”¨æˆ·å¯†ç  â†’ åŠ å¯†å¯†é’¥ (Argon2id)
    pub fn derive_key(password: &str, salt: &[u8]) -> Result<Vec<u8>> {
        let argon2 = Argon2::default();
        
        let password_hash = argon2.hash_password(
            password.as_bytes(),
            salt,
        )?;
        
        Ok(password_hash.hash.unwrap().as_bytes().to_vec())
    }
    
    /// AES-256-GCM åŠ å¯†åŠ©è®°è¯
    pub fn encrypt_mnemonic(
        mnemonic: &str,
        password: &str,
    ) -> Result<String> {
        // 1. ç”Ÿæˆéšæœºç›
        let mut salt = [0u8; 32];
        rand::thread_rng().fill_bytes(&mut salt);
        
        // 2. æ´¾ç”ŸåŠ å¯†å¯†é’¥
        let key = Self::derive_key(password, &salt)?;
        let cipher = Aes256Gcm::new(Key::from_slice(&key));
        
        // 3. ç”Ÿæˆéšæœº Nonce
        let mut nonce = [0u8; 12];
        rand::thread_rng().fill_bytes(&mut nonce);
        
        // 4. åŠ å¯†
        let ciphertext = cipher.encrypt(
            Nonce::from_slice(&nonce),
            mnemonic.as_bytes(),
        )?;
        
        // 5. ç»„åˆ: salt + nonce + ciphertext
        let mut result = Vec::new();
        result.extend_from_slice(&salt);
        result.extend_from_slice(&nonce);
        result.extend_from_slice(&ciphertext);
        
        // 6. Base64 ç¼–ç 
        Ok(base64::encode(&result))
    }
    
    /// AES-256-GCM è§£å¯†åŠ©è®°è¯
    pub fn decrypt_mnemonic(
        encrypted: &str,
        password: &str,
    ) -> Result<String> {
        // 1. Base64 è§£ç 
        let data = base64::decode(encrypted)?;
        
        // 2. åˆ†ç¦»: salt (32) + nonce (12) + ciphertext
        let salt = &data[0..32];
        let nonce = &data[32..44];
        let ciphertext = &data[44..];
        
        // 3. æ´¾ç”Ÿè§£å¯†å¯†é’¥
        let key = Self::derive_key(password, salt)?;
        let cipher = Aes256Gcm::new(Key::from_slice(&key));
        
        // 4. è§£å¯†
        let plaintext = cipher.decrypt(
            Nonce::from_slice(nonce),
            ciphertext,
        )?;
        
        // 5. è½¬æ¢ä¸ºå­—ç¬¦ä¸²
        Ok(String::from_utf8(plaintext)?)
    }
}
```

### å‰ç«¯å­˜å‚¨ Rust å®ç°

```rust
// src/infrastructure/storage/wallet_storage.rs

use rexie::{Rexie, Store, ObjectStore};
use serde::{Serialize, Deserialize};

#[derive(Serialize, Deserialize, Clone)]
pub struct StoredWallet {
    pub id: String,
    pub name: String,
    pub encrypted_mnemonic: String,
    pub password_hash: String,
    pub addresses: Vec<Address>,
    pub created_at: i64,
}

pub struct WalletStorage {
    db: Rexie,
}

impl WalletStorage {
    /// åˆå§‹åŒ– IndexedDB
    pub async fn new() -> Result<Self> {
        let db = Rexie::builder("ironforge_wallet")
            .version(1)
            .add_object_store(
                ObjectStore::new("wallets")
                    .key_path("id")
                    .auto_increment(false)
            )
            .build()
            .await?;
        
        Ok(Self { db })
    }
    
    /// ä¿å­˜é’±åŒ…ï¼ˆåŠ å¯†åï¼‰
    pub async fn save_wallet(&self, wallet: &StoredWallet) -> Result<()> {
        let tx = self.db.transaction(&["wallets"], TransactionMode::ReadWrite)?;
        let store = tx.store("wallets")?;
        
        store.put(&serde_wasm_bindgen::to_value(wallet)?).await?;
        tx.commit().await?;
        
        Ok(())
    }
    
    /// è¯»å–é’±åŒ…
    pub async fn get_wallet(&self, id: &str) -> Result<Option<StoredWallet>> {
        let tx = self.db.transaction(&["wallets"], TransactionMode::ReadOnly)?;
        let store = tx.store("wallets")?;
        
        let value = store.get(&id.into()).await?;
        
        match value {
            Some(v) => Ok(Some(serde_wasm_bindgen::from_value(v)?)),
            None => Ok(None),
        }
    }
    
    /// åˆ—å‡ºæ‰€æœ‰é’±åŒ…
    pub async fn list_wallets(&self) -> Result<Vec<StoredWallet>> {
        let tx = self.db.transaction(&["wallets"], TransactionMode::ReadOnly)?;
        let store = tx.store("wallets")?;
        
        let values = store.get_all(None).await?;
        
        let wallets = values
            .into_iter()
            .filter_map(|v| serde_wasm_bindgen::from_value(v).ok())
            .collect();
        
        Ok(wallets)
    }
    
    /// åˆ é™¤é’±åŒ…
    pub async fn delete_wallet(&self, id: &str) -> Result<()> {
        let tx = self.db.transaction(&["wallets"], TransactionMode::ReadWrite)?;
        let store = tx.store("wallets")?;
        
        store.delete(&id.into()).await?;
        tx.commit().await?;
        
        Ok(())
    }
}
```

---

## ğŸ¢ åç«¯æ•°æ®å­˜å‚¨

### åç«¯æ•°æ®åº“è®¾è®¡ (CockroachDB / PostgreSQL)

#### æ•°æ®åº“ç»„åˆæ–¹æ¡ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CockroachDB (äº‹åŠ¡ä¸»åº“)                 â”‚
â”‚   ç”¨é€”ï¼šä¸šåŠ¡æ•°æ®å­˜å‚¨                      â”‚
â”‚   ç‰¹ç‚¹ï¼šACIDäº‹åŠ¡ã€åˆ†å¸ƒå¼ã€å¼ºä¸€è‡´æ€§       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Redis (ç¼“å­˜å±‚)                         â”‚
â”‚   ç”¨é€”ï¼šä¼šè¯ã€é™æµã€çƒ­ç‚¹æ•°æ®ç¼“å­˜          â”‚
â”‚   ç‰¹ç‚¹ï¼šå†…å­˜å­˜å‚¨ã€é«˜æ€§èƒ½ã€TTLè¿‡æœŸ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Immudb (å®¡è®¡è´¦æœ¬)                      â”‚
â”‚   ç”¨é€”ï¼šå…³é”®äº‹ä»¶å­˜è¯ã€åˆè§„å®¡è®¡            â”‚
â”‚   ç‰¹ç‚¹ï¼šä¸å¯ç¯¡æ”¹ã€å¯éªŒè¯è¯æ˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å®Œæ•´ SQL Schema

```sql
-- ============================================
-- å¤šç§Ÿæˆ·è¡¨ï¼ˆå¯é€‰ï¼Œä¼ä¸šç‰ˆåŠŸèƒ½ï¼‰
-- ============================================
CREATE TABLE tenants (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    plan VARCHAR(50) DEFAULT 'free',      -- free, pro, enterprise
    max_wallets INT DEFAULT 10,
    max_transactions_per_day INT DEFAULT 100,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_tenants_plan (plan)
);

-- ============================================
-- ç”¨æˆ·è¡¨
-- ============================================
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID REFERENCES tenants(id),  -- å¯é€‰ï¼Œå¤šç§Ÿæˆ·åœºæ™¯
    email VARCHAR(255) UNIQUE NOT NULL,
    email_cipher TEXT,                    -- åŠ å¯†åçš„é‚®ç®±ï¼ˆä¼ä¸šåˆè§„ï¼‰
    password_hash VARCHAR(255) NOT NULL,  -- Argon2id å“ˆå¸Œ
    role VARCHAR(20) DEFAULT 'user',      -- user, admin, super_admin
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    last_login_at TIMESTAMPTZ,
    status VARCHAR(20) DEFAULT 'active',  -- active, suspended, deleted
    
    INDEX idx_users_email (email),
    INDEX idx_users_tenant_id (tenant_id),
    INDEX idx_users_status (status)
);

-- ============================================
-- é’±åŒ…å…ƒæ•°æ®è¡¨ï¼ˆä¸å«ç§é’¥ï¼‰
-- ============================================
CREATE TABLE wallets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID REFERENCES tenants(id),        -- å¤šç§Ÿæˆ·éš”ç¦»
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    name VARCHAR(100) NOT NULL,                   -- "My Main Wallet"
    chain VARCHAR(20) NOT NULL,                   -- "ethereum", "bitcoin", "ton"
    chain_id INT NOT NULL,                        -- 1 (ETH), 56 (BSC), 607 (TON)
    address VARCHAR(255) NOT NULL,                -- å…¬å¼€åœ°å€
    pubkey TEXT,                                  -- å…¬é’¥ï¼ˆå¯é€‰ï¼‰
    derivation_path VARCHAR(50),                  -- "m/44'/60'/0'/0/0"
    policy_id UUID REFERENCES policies(id),       -- å¤šç­¾ç­–ç•¥ï¼ˆå¯é€‰ï¼‰
    balance DECIMAL(36, 18) DEFAULT 0,            -- ä½™é¢å¿«ç…§ï¼ˆç¼“å­˜ï¼‰
    balance_updated_at TIMESTAMPTZ,               -- ä½™é¢æ›´æ–°æ—¶é—´
    is_default BOOLEAN DEFAULT false,             -- æ˜¯å¦é»˜è®¤é’±åŒ…
    tags TEXT[],                                  -- æ ‡ç­¾æ•°ç»„
    metadata JSONB,                               -- æ‰©å±•å…ƒæ•°æ®
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    -- âŒ ä¸å­˜å‚¨: encrypted_mnemonic, private_key
    
    UNIQUE (user_id, chain, address),
    INDEX idx_wallets_tenant_id (tenant_id),
    INDEX idx_wallets_user_id (user_id),
    INDEX idx_wallets_chain (chain),
    INDEX idx_wallets_chain_id (chain_id),
    INDEX idx_wallets_address (address)
);

-- ============================================
-- å¤šç­¾ç­–ç•¥è¡¨ï¼ˆå¯é€‰ï¼Œä¼ä¸šåŠŸèƒ½ï¼‰
-- ============================================
CREATE TABLE policies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID REFERENCES tenants(id),
    name VARCHAR(100) NOT NULL,
    required_approvals INT NOT NULL DEFAULT 1,
    approvers UUID[] NOT NULL,                    -- å®¡æ‰¹äºº user_id æ•°ç»„
    created_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_policies_tenant_id (tenant_id)
);

-- ============================================
-- å®¡æ‰¹è®°å½•è¡¨ï¼ˆå¯é€‰ï¼Œä¼ä¸šåŠŸèƒ½ï¼‰
-- ============================================
CREATE TABLE approvals (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tx_request_id UUID NOT NULL REFERENCES tx_requests(id),
    approver_id UUID NOT NULL REFERENCES users(id),
    status VARCHAR(20) NOT NULL,                  -- pending, approved, rejected
    comment TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    
    UNIQUE (tx_request_id, approver_id),
    INDEX idx_approvals_tx_request (tx_request_id),
    INDEX idx_approvals_approver (approver_id)
);

-- ============================================
-- äº¤æ˜“è¯·æ±‚è¡¨ï¼ˆå‘èµ·äº¤æ˜“ï¼‰
-- ============================================
CREATE TABLE tx_requests (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID REFERENCES tenants(id),
    wallet_id UUID NOT NULL REFERENCES wallets(id),
    chain VARCHAR(20) NOT NULL,
    chain_id INT NOT NULL,
    to_address VARCHAR(255) NOT NULL,
    amount DECIMAL(36, 18) NOT NULL,
    token_symbol VARCHAR(20),
    token_contract VARCHAR(255),
    data TEXT,                            -- åˆçº¦è°ƒç”¨æ•°æ®
    nonce BIGINT,
    gas_limit BIGINT,
    gas_price DECIMAL(36, 18),
    status VARCHAR(20) NOT NULL DEFAULT 'draft',  
    -- draft/pending_approval/approved/signed/broadcasted/confirmed/failed
    metadata JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_tx_requests_tenant_id (tenant_id),
    INDEX idx_tx_requests_wallet_id (wallet_id),
    INDEX idx_tx_requests_status (status)
);

-- ============================================
-- äº¤æ˜“å†å²è¡¨ï¼ˆé“¾ä¸Šå·²ç¡®è®¤ï¼‰
-- ============================================
CREATE TABLE transactions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID REFERENCES tenants(id),
    wallet_id UUID NOT NULL REFERENCES wallets(id) ON DELETE CASCADE,
    tx_request_id UUID REFERENCES tx_requests(id),  -- å…³è”äº¤æ˜“è¯·æ±‚
    tx_hash VARCHAR(255) NOT NULL,        -- äº¤æ˜“å“ˆå¸Œ
    chain VARCHAR(20) NOT NULL,
    chain_id INT NOT NULL,
    from_address VARCHAR(255) NOT NULL,
    to_address VARCHAR(255) NOT NULL,
    amount DECIMAL(36, 18) NOT NULL,
    token_symbol VARCHAR(20),             -- "ETH", "BTC", "USDT"
    token_contract VARCHAR(255),          -- ERC20 åˆçº¦åœ°å€
    fee DECIMAL(36, 18),                  -- Gas è´¹ç”¨
    status VARCHAR(20) NOT NULL,          -- pending, confirmed, failed
    block_number BIGINT,
    confirmations INT DEFAULT 0,
    timestamp TIMESTAMPTZ NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    
    UNIQUE (chain, tx_hash),
    INDEX idx_tx_tenant_id (tenant_id),
    INDEX idx_tx_wallet_id (wallet_id),
    INDEX idx_tx_chain_hash (chain, tx_hash),
    INDEX idx_tx_timestamp (timestamp DESC),
    INDEX idx_tx_status (status)
);

-- ============================================
-- ä»£å¸ä½™é¢è¡¨
-- ============================================
CREATE TABLE token_balances (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    wallet_id UUID NOT NULL REFERENCES wallets(id) ON DELETE CASCADE,
    chain VARCHAR(20) NOT NULL,
    token_symbol VARCHAR(20) NOT NULL,
    token_name VARCHAR(100),
    token_contract VARCHAR(255),
    balance DECIMAL(36, 18) DEFAULT 0,
    decimals INT DEFAULT 18,
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    UNIQUE (wallet_id, chain, token_contract),
    INDEX idx_token_wallet_id (wallet_id)
);

-- ============================================
-- å®¡è®¡æ—¥å¿—è¡¨ï¼ˆé‡è¦æ“ä½œè®°å½•ï¼‰
-- ============================================
CREATE TABLE audit_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    wallet_id UUID REFERENCES wallets(id),
    action VARCHAR(50) NOT NULL,          -- "wallet_created", "transaction_sent"
    ip_address INET,
    user_agent TEXT,
    details JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_audit_user_id (user_id),
    INDEX idx_audit_created_at (created_at DESC)
);

-- ============================================
-- ä¼šè¯è¡¨ï¼ˆå¯é€‰ï¼ŒRedis æ›¿ä»£æ–¹æ¡ˆï¼‰
-- ============================================
CREATE TABLE sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    token_hash VARCHAR(255) UNIQUE NOT NULL,
    expires_at TIMESTAMPTZ NOT NULL,
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_sessions_user_id (user_id),
    INDEX idx_sessions_expires_at (expires_at)
);
```

### Redis ç¼“å­˜ç»“æ„

```
# ä¼šè¯ç¼“å­˜
session:{token_hash}
  -> { user_id, email, expires_at }
  TTL: 24 hours

# ä½™é¢ç¼“å­˜
balance:{wallet_id}
  -> { balance, updated_at }
  TTL: 5 minutes

# API å“åº”ç¼“å­˜
api:wallets:{user_id}
  -> [ wallet1, wallet2, ... ]
  TTL: 1 minute

# é€Ÿç‡é™åˆ¶
ratelimit:{user_id}:{endpoint}
  -> request_count
  TTL: 1 minute
```

---

## ğŸ”„ æ•°æ®æµè®¾è®¡

### åˆ›å»ºé’±åŒ…æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·è¾“å…¥é’±åŒ…åç§° + å¯†ç                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. å‰ç«¯ç”Ÿæˆ BIP39 åŠ©è®°è¯ (12/24 è¯)                         â”‚
â”‚    - ä½¿ç”¨ getrandom (WASM éšæœºæ•°)                           â”‚
â”‚    - å®Œå…¨åœ¨æµè§ˆå™¨æ‰§è¡Œ                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. å‰ç«¯ç”¨å¯†ç åŠ å¯†åŠ©è®°è¯                                      â”‚
â”‚    - Argon2id æ´¾ç”ŸåŠ å¯†å¯†é’¥                                   â”‚
â”‚    - AES-256-GCM åŠ å¯†                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å‰ç«¯ä¿å­˜åˆ° IndexedDB                                      â”‚
â”‚    - wallet_id: UUID                                        â”‚
â”‚    - encrypted_mnemonic: base64                             â”‚
â”‚    - addresses: [{ chain, address }]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å‰ç«¯è°ƒç”¨åç«¯ API: POST /api/wallets                      â”‚
â”‚    Body: {                                                  â”‚
â”‚      name: "My Wallet",                                     â”‚
â”‚      chain: "ethereum",                                     â”‚
â”‚      address: "0x1234..."  // å…¬å¼€åœ°å€                      â”‚
â”‚    }                                                        â”‚
â”‚    âŒ ä¸å‘é€: mnemonic, private_key, password              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. åç«¯ä¿å­˜å…ƒæ•°æ®åˆ°æ•°æ®åº“                                    â”‚
â”‚    - INSERT INTO wallets (user_id, name, address)           â”‚
â”‚    - è¿”å› wallet_id                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‘é€äº¤æ˜“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·è¾“å…¥: æ¥æ”¶åœ°å€ + é‡‘é¢                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. å‰ç«¯å¼¹å‡ºå¯†ç ç¡®è®¤æ¡†                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. å‰ç«¯ç”¨å¯†ç è§£å¯†åŠ©è®°è¯                                      â”‚
â”‚    - ä» IndexedDB è¯»å– encrypted_mnemonic                   â”‚
â”‚    - AES-256-GCM è§£å¯†                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å‰ç«¯æ´¾ç”Ÿç§é’¥å¹¶ç­¾åäº¤æ˜“                                    â”‚
â”‚    - BIP32 æ´¾ç”Ÿ: mnemonic â†’ seed â†’ private_key              â”‚
â”‚    - ç­¾å: sign(tx, private_key)                            â”‚
â”‚    - ç«‹å³æ¸…é›¶: zeroize(private_key)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å‰ç«¯å¹¿æ’­åˆ°åŒºå—é“¾ RPC                                      â”‚
â”‚    - ç›´æ¥è°ƒç”¨é“¾çš„ RPC èŠ‚ç‚¹                                   â”‚
â”‚    - æˆ–é€šè¿‡åç«¯ä»£ç†: POST /api/transactions/broadcast       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. å‰ç«¯é€šçŸ¥åç«¯è®°å½•äº¤æ˜“                                      â”‚
â”‚    POST /api/transactions                                   â”‚
â”‚    Body: {                                                  â”‚
â”‚      wallet_id: "uuid",                                     â”‚
â”‚      tx_hash: "0xabc...",                                   â”‚
â”‚      from: "0x123...",                                      â”‚
â”‚      to: "0x456...",                                        â”‚
â”‚      amount: "1.5"                                          â”‚
â”‚    }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. åç«¯ä¿å­˜äº¤æ˜“è®°å½•åˆ°æ•°æ®åº“                                  â”‚
â”‚    - INSERT INTO transactions                               â”‚
â”‚    - æä¾›å†å²æŸ¥è¯¢                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ å®‰å…¨ä¿è¯

### 1. ç§é’¥æ°¸ä¸ç¦»å¼€æµè§ˆå™¨

```rust
// âœ… æ­£ç¡®ï¼šç§é’¥ä»…åœ¨å†…å­˜ä¸­ä¸´æ—¶å­˜åœ¨
let private_key = derive_private_key(&mnemonic);
let signature = sign_transaction(&tx, &private_key);
zeroize::Zeroize::zeroize(&mut private_key);  // ç«‹å³æ¸…é›¶

// âŒ é”™è¯¯ï¼šç§é’¥å‘é€åˆ°åç«¯
let response = api_client.post("/api/sign")
    .json(&private_key)  // ç»å¯¹ç¦æ­¢ï¼
    .send()
    .await?;
```

### 2. åç«¯æ— æ³•è§£å¯†åŠ©è®°è¯

åç«¯å³ä½¿è·å–åˆ° `encrypted_mnemonic`ï¼Œä¹Ÿæ— æ³•è§£å¯†ï¼Œå› ä¸ºï¼š
- åŠ å¯†å¯†é’¥ä»ç”¨æˆ·å¯†ç æ´¾ç”Ÿï¼ˆåç«¯ä¸çŸ¥é“ï¼‰
- æ¯ä¸ªé’±åŒ…ä½¿ç”¨ä¸åŒçš„éšæœºç›
- ä½¿ç”¨ Argon2idï¼ˆæ…¢é€Ÿå“ˆå¸Œï¼Œé˜²æš´åŠ›ç ´è§£ï¼‰

### 3. é›¶ä¿¡ä»»æ¶æ„

```
å‡è®¾åœºæ™¯ï¼šåç«¯æ•°æ®åº“è¢«é»‘å®¢æ”»ç ´

é»‘å®¢è·å¾—ï¼š
  âœ… ç”¨æˆ·é‚®ç®±
  âœ… é’±åŒ…åœ°å€
  âœ… äº¤æ˜“å†å²
  âŒ ç§é’¥ï¼ˆå‰ç«¯å­˜å‚¨ï¼‰
  âŒ åŠ©è®°è¯ï¼ˆå‰ç«¯åŠ å¯†ï¼‰
  âŒ ç”¨æˆ·å¯†ç ï¼ˆArgon2id å“ˆå¸Œï¼‰

ç»“æœï¼š
  - é»‘å®¢æ— æ³•è½¬ç§»èµ„äº§ âœ…
  - é»‘å®¢æ— æ³•ç­¾åäº¤æ˜“ âœ…
  - ç”¨æˆ·èµ„äº§ä»ç„¶å®‰å…¨ âœ…
```

### 4. å®¡è®¡æ—¥å¿—ä¸å¯ç¯¡æ”¹

ä½¿ç”¨ Immudbï¼ˆä¸å¯å˜æ•°æ®åº“ï¼‰è®°å½•æ‰€æœ‰æ•æ„Ÿæ“ä½œï¼š
- é’±åŒ…åˆ›å»º
- äº¤æ˜“å‘é€
- ç™»å½•è®°å½•
- é…ç½®ä¿®æ”¹

### 5. å¤šå±‚é˜²æŠ¤

| å±‚çº§ | é˜²æŠ¤æªæ–½ |
|------|---------|
| **ä¼ è¾“å±‚** | HTTPS + Certificate Pinning |
| **åº”ç”¨å±‚** | JWT Token + CSRF Token |
| **æ•°æ®å±‚** | AES-256-GCM + Argon2id |
| **ç‰©ç†å±‚** | IndexedDB é™åˆ¶åŒæºè®¿é—® |
| **å®¡è®¡å±‚** | Immudb é˜²ç¯¡æ”¹æ—¥å¿— |

---

## âœ… æ€»ç»“

IronForge V2 çš„æ•°æ®åˆ†ç¦»æ¨¡å‹ç¡®ä¿ï¼š

1. **ç”¨æˆ·èµ„äº§å®‰å…¨** - ç§é’¥æœ¬åœ°å­˜å‚¨ï¼Œç”¨æˆ·å®Œå…¨æŒæ§
2. **ä¾¿åˆ©æ€§** - åç«¯æä¾›ä¼ä¸šçº§æŸ¥è¯¢å’Œç»Ÿè®¡æœåŠ¡
3. **å¯æ¢å¤æ€§** - å…ƒæ•°æ®ä¸¢å¤±å¯æ¢å¤ï¼Œç§é’¥ä¸¢å¤±ç”¨æˆ·è´£ä»»
4. **åˆè§„æ€§** - æ»¡è¶³å®¡è®¡å’Œç›‘ç®¡è¦æ±‚
5. **å¯æ‰©å±•æ€§** - æ”¯æŒå¤šè®¾å¤‡ã€å¤šé“¾ã€å¤šç”¨æˆ·

è¿™æ˜¯ **éæ‰˜ç®¡é’±åŒ…** å’Œ **ä¼ä¸šæœåŠ¡** çš„å®Œç¾å¹³è¡¡ã€‚

---

**ä¸‹ä¸€æ­¥**: é˜…è¯» [å®‰å…¨æ¶æ„è®¾è®¡](../04-security/01-security-architecture.md)

**æœ€åæ›´æ–°**: 2025-11-25
