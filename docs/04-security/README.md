# å®‰å…¨æ¶æ„ (Security Architecture)

> ğŸ” å¯†é’¥ç®¡ç†ã€åŠ å¯†ç­–ç•¥ã€è®¤è¯æˆæƒã€å®‰å…¨å®¡è®¡

---

## ğŸ“‚ æœ¬åˆ†ç±»æ–‡æ¡£

| æ–‡æ¡£ | æè¿° | è¡Œæ•° | æœ€åæ›´æ–° | çŠ¶æ€ |
|------|------|------|----------|------|
| [01-key-management.md](./01-key-management.md) | ç§é’¥ç®¡ç†ã€åŠ©è®°è¯ç”Ÿæˆã€å¯†é’¥æ´¾ç”Ÿ | 844 | 2025-11-25 | âœ… å®Œæˆ |
| [02-encryption-strategy.md](./02-encryption-strategy.md) | åŠ å¯†ç®—æ³•ã€å¯†ç å­¦å®è·µ | 712 | 2025-11-25 | âœ… å®Œæˆ |
| [03-security-architecture.md](./03-security-architecture.md) | æ•´ä½“å®‰å…¨æ¶æ„ã€å¨èƒæ¨¡å‹ | 896 | 2025-11-25 | âœ… å®Œæˆ |
| [05-production-encryption-guide.md](./05-production-encryption-guide.md) | ç”Ÿäº§ç¯å¢ƒåŠ å¯†é…ç½® | 654 | 2025-11-25 | âœ… å®Œæˆ |
| [AUTH_401_DIAGNOSTIC_GUIDE.md](./AUTH_401_DIAGNOSTIC_GUIDE.md) | 401 é”™è¯¯è¯Šæ–­ä¸ä¿®å¤ â­ | 315 | 2025-12-04 | âœ… å®Œæˆ |

**æ€»è®¡**: 5 ä¸ªæ–‡æ¡£ï¼Œ3,421+ è¡Œ

---

## ğŸ¯ å¿«é€Ÿå¯¼èˆª

### æ ¸å¿ƒå®‰å…¨
- ğŸ”‘ **[å¯†é’¥ç®¡ç†](./01-key-management.md)** - ç§é’¥ç”Ÿæˆã€å­˜å‚¨ã€æ´¾ç”Ÿ
- ğŸ”’ **[åŠ å¯†ç­–ç•¥](./02-encryption-strategy.md)** - AES-256-GCM, Argon2id
- ğŸ° **[å®‰å…¨æ¶æ„](./03-security-architecture.md)** - é›¶ä¿¡ä»»ã€å¨èƒæ¨¡å‹

### ç”Ÿäº§å®è·µ
- ğŸš€ **[ç”Ÿäº§åŠ å¯†æŒ‡å—](./05-production-encryption-guide.md)** - ç¯å¢ƒé…ç½®ã€å¯†é’¥è½®æ¢
- ğŸ› **[401 é”™è¯¯è¯Šæ–­](./AUTH_401_DIAGNOSTIC_GUIDE.md)** - è®¤è¯é—®é¢˜å¿«é€Ÿæ’æŸ¥

---

## ğŸ—ï¸ å®‰å…¨æ¶æ„æ¦‚è§ˆ

### éæ‰˜ç®¡å®‰å…¨æ¨¡å‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Browser (å®¢æˆ·ç«¯ - 100% ä¿¡ä»»è¾¹ç•Œ)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Private Keys (ç”¨æˆ·å®Œå…¨æŒæ§)                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  BIP39 Mnemonic (12/24 words)            â”‚ â”‚  â”‚ â† ğŸ”‘ ç”¨æˆ·å¤‡ä»½
â”‚  â”‚  â”‚  â†“ PBKDF2                                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  Master Seed (512 bits)                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â†“ BIP32/BIP44 Derivation               â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  Private Keys (per chain/account)        â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  IndexedDB åŠ å¯†å­˜å‚¨                       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - AES-256-GCM encryption                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - User password derived key (Argon2id) â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Salt + IV unique per wallet           â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Transaction Signing (å®¢æˆ·ç«¯ç­¾å)              â”‚  â”‚
â”‚  â”‚  1. æ„é€  Raw Transaction                       â”‚  â”‚
â”‚  â”‚  2. ä½¿ç”¨ Private Key ç­¾å                      â”‚  â”‚
â”‚  â”‚  3. å‘é€ Signed Tx åˆ°åŒºå—é“¾                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“ HTTP (Only public data)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          IronCore Backend (é›¶ä¿¡ä»»åŒºåŸŸ)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸš« Never stores: Private Keys, Mnemonics             â”‚
â”‚  âœ… Only stores: Wallet addresses, tx hashes, metadataâ”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  JWT Authentication                             â”‚  â”‚
â”‚  â”‚  - 1 hour expiry                                â”‚  â”‚
â”‚  â”‚  - Refresh token (7 days)                       â”‚  â”‚
â”‚  â”‚  - HttpOnly cookie                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Metadata Database                              â”‚  â”‚
â”‚  â”‚  - users (email, hashed password)               â”‚  â”‚
â”‚  â”‚  - wallets (name, address, chain)               â”‚  â”‚
â”‚  â”‚  - transactions (hash, status, timestamp)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒå®‰å…¨åŸåˆ™

1. **é›¶ä¿¡ä»»æ¶æ„** - åç«¯æ°¸è¿œä¸æ¥è§¦ç§é’¥
2. **å®¢æˆ·ç«¯ç­¾å** - æ‰€æœ‰äº¤æ˜“åœ¨å‰ç«¯ç­¾å
3. **åŠ å¯†å­˜å‚¨** - IndexedDB ä½¿ç”¨ AES-256-GCM åŠ å¯†
4. **å¯†é’¥æ´¾ç”Ÿ** - ä½¿ç”¨è¡Œä¸šæ ‡å‡† BIP39/BIP32/BIP44
5. **å¯†ç ä¿æŠ¤** - Argon2id å¯†é’¥æ´¾ç”Ÿå‡½æ•°ï¼ˆKDFï¼‰

---

## ğŸ“š å®‰å…¨æ–‡æ¡£è¯¦è§£

### 1ï¸âƒ£ [å¯†é’¥ç®¡ç†](./01-key-management.md)
**é˜…è¯»æ—¶é•¿**: 20 åˆ†é’Ÿ  
**é€‚åˆ**: å®‰å…¨å®¡è®¡ã€æ¶æ„å¸ˆã€å‰ç«¯å·¥ç¨‹å¸ˆ

**æ ¸å¿ƒå†…å®¹**:
- ğŸŒ± **åŠ©è®°è¯ç”Ÿæˆ**: BIP39 æ ‡å‡†ï¼Œ12/24 è¯
- ğŸ”‘ **å¯†é’¥æ´¾ç”Ÿ**: BIP32 (HD Wallet), BIP44 (Multi-Chain)
- ğŸ’¾ **å®‰å…¨å­˜å‚¨**: IndexedDB + AES-256-GCM åŠ å¯†
- ğŸ” **å¯†ç ç®¡ç†**: Argon2id KDF, ç›å€¼ç”Ÿæˆ
- ğŸ”„ **å¯†é’¥æ¢å¤**: åŠ©è®°è¯ â†’ å®Œæ•´æ¢å¤æ‰€æœ‰é’±åŒ…

**å¯†é’¥æ´¾ç”Ÿè·¯å¾„**:
```
Master Seed (512 bits)
  â†“ BIP44 Derivation
m/44'/coin_type'/account'/change/address_index

Examples:
- Ethereum:  m/44'/60'/0'/0/0
- Bitcoin:   m/84'/0'/0'/0/0
- BSC:       m/44'/60'/0'/0/0 (same as ETH)
- Polygon:   m/44'/60'/0'/0/0
```

**ä»£ç ç¤ºä¾‹**:
```rust
// ç”ŸæˆåŠ©è®°è¯
let mnemonic = Mnemonic::generate(WordCount::Words12)?;

// æ´¾ç”Ÿç§å­
let seed = mnemonic.to_seed("");

// æ´¾ç”Ÿä»¥å¤ªåŠç§é’¥
let path = "m/44'/60'/0'/0/0";
let private_key = derive_private_key(&seed, path)?;

// åŠ å¯†å­˜å‚¨
let encrypted = encrypt_with_password(
    &private_key,
    user_password,
    &salt,
    &iv
)?;
save_to_indexeddb(&encrypted).await?;
```

---

### 2ï¸âƒ£ [åŠ å¯†ç­–ç•¥](./02-encryption-strategy.md)
**é˜…è¯»æ—¶é•¿**: 15 åˆ†é’Ÿ  
**é€‚åˆ**: å®‰å…¨å·¥ç¨‹å¸ˆã€å®¡è®¡äººå‘˜

**æ ¸å¿ƒå†…å®¹**:
- ğŸ”’ **å¯¹ç§°åŠ å¯†**: AES-256-GCM (Galois/Counter Mode)
- ğŸ” **å¯†é’¥æ´¾ç”Ÿ**: Argon2id (å†…å­˜ç¡¬å‡½æ•°)
- ğŸ² **éšæœºæ•°ç”Ÿæˆ**: CSPRNG (Cryptographically Secure)
- ğŸ“ **æ¶ˆæ¯è®¤è¯**: HMAC-SHA256
- ğŸ” **ç­¾åç®—æ³•**: ECDSA (secp256k1)

**åŠ å¯†å‚æ•°**:
```rust
// AES-256-GCM é…ç½®
const KEY_SIZE: usize = 32;      // 256 bits
const IV_SIZE: usize = 12;       // 96 bits (recommended)
const TAG_SIZE: usize = 16;      // 128 bits

// Argon2id é…ç½®
const ARGON2_MEM: u32 = 64 * 1024;  // 64 MB
const ARGON2_ITERATIONS: u32 = 3;
const ARGON2_PARALLELISM: u32 = 4;
const SALT_SIZE: usize = 16;        // 128 bits
```

**åŠ å¯†æµç¨‹**:
```rust
// 1. å¯†é’¥æ´¾ç”Ÿ
let key = argon2id_derive(
    user_password,
    &salt,
    ARGON2_MEM,
    ARGON2_ITERATIONS
)?;

// 2. åŠ å¯†æ•°æ®
let iv = generate_random_iv();
let ciphertext = aes_256_gcm_encrypt(
    &plaintext,
    &key,
    &iv
)?;

// 3. å­˜å‚¨æ ¼å¼
let stored = StoredSecret {
    salt,
    iv,
    ciphertext,
    tag,  // GCM authentication tag
};
```

---

### 3ï¸âƒ£ [å®‰å…¨æ¶æ„](./03-security-architecture.md)
**é˜…è¯»æ—¶é•¿**: 20 åˆ†é’Ÿ  
**é€‚åˆ**: æ¶æ„å¸ˆã€CTOã€å®‰å…¨è´Ÿè´£äºº

**æ ¸å¿ƒå†…å®¹**:
- ğŸ° **æ•´ä½“å®‰å…¨æ¶æ„** - åˆ†å±‚é˜²å¾¡ã€çºµæ·±é˜²å¾¡
- ğŸ¯ **å¨èƒæ¨¡å‹** - STRIDE åˆ†æï¼ˆSpoofing, Tampering...ï¼‰
- ğŸ›¡ï¸ **é˜²å¾¡æªæ–½** - å„å±‚å®‰å…¨æ§åˆ¶
- ğŸ“Š **å®‰å…¨å®¡è®¡** - æ—¥å¿—ã€ç›‘æ§ã€å‘Šè­¦
- ğŸ“‹ **åˆè§„æ€§** - GDPR, SOC 2, PCI DSS

**STRIDE å¨èƒåˆ†æ**:
| å¨èƒ | ç¤ºä¾‹ | é˜²å¾¡æªæ–½ |
|------|------|----------|
| **Spoofing** (ä¼ªé€ ) | å†’å……ç”¨æˆ·ç™»å½• | JWT Token, MFA |
| **Tampering** (ç¯¡æ”¹) | ä¿®æ”¹äº¤æ˜“æ•°æ® | å®¢æˆ·ç«¯ç­¾å, HTTPS |
| **Repudiation** (æŠµèµ–) | å¦è®¤æ“ä½œ | å®¡è®¡æ—¥å¿—, æ—¶é—´æˆ³ |
| **Info Disclosure** (æ³„éœ²) | ç§é’¥æ³„éœ² | åŠ å¯†å­˜å‚¨, é›¶æ—¥å¿— |
| **DoS** (æ‹’ç»æœåŠ¡) | API è¿‡è½½ | Rate Limiting, WAF |
| **Elevation** (ææƒ) | è¶Šæƒè®¿é—® | RBAC, æœ€å°æƒé™ |

**å®‰å…¨è¾¹ç•Œ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®¢æˆ·ç«¯ (ä¿¡ä»»è¾¹ç•Œå†…)                     â”‚
â”‚  - Private Keys                          â”‚ â† ğŸ”’ ç”¨æˆ·å®Œå…¨æ§åˆ¶
â”‚  - Mnemonics                             â”‚
â”‚  - Transaction Signing                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ HTTPS (TLS 1.3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾¹ç•Œå±‚ (API Gateway)                    â”‚
â”‚  - Rate Limiting                         â”‚ â† ğŸ›¡ï¸ ç¬¬ä¸€é“é˜²çº¿
â”‚  - DDoS Protection                       â”‚
â”‚  - WAF (Web Application Firewall)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ JWT Token
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åº”ç”¨å±‚ (IronCore Backend)               â”‚
â”‚  - Authentication (JWT)                  â”‚ â† ğŸ” èº«ä»½éªŒè¯
â”‚  - Authorization (RBAC)                  â”‚
â”‚  - Input Validation                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ Encrypted Connection
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®å±‚ (Database)                       â”‚
â”‚  - Encrypted at Rest                     â”‚ â† ğŸ—„ï¸ åŠ å¯†å­˜å‚¨
â”‚  - Encrypted in Transit                  â”‚
â”‚  - Access Control                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4ï¸âƒ£ [ç”Ÿäº§åŠ å¯†æŒ‡å—](./05-production-encryption-guide.md)
**é˜…è¯»æ—¶é•¿**: 12 åˆ†é’Ÿ  
**é€‚åˆ**: DevOps, SRE, åç«¯å·¥ç¨‹å¸ˆ

**æ ¸å¿ƒå†…å®¹**:
- ğŸ”§ **ç¯å¢ƒé…ç½®** - å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒå¯†é’¥ç®¡ç†
- ğŸ”„ **å¯†é’¥è½®æ¢** - å®šæœŸæ›´æ¢åŠ å¯†å¯†é’¥
- ğŸ” **å¯†é’¥å­˜å‚¨** - ä½¿ç”¨ HSM / KMS ä¿æŠ¤å¯†é’¥
- ğŸ“Š **ç›‘æ§å‘Šè­¦** - åŠ å¯†å¤±è´¥ã€å¯†é’¥è¿‡æœŸç›‘æ§
- ğŸ“ **ç¾éš¾æ¢å¤** - å¯†é’¥å¤‡ä»½ä¸æ¢å¤æµç¨‹

**ç”Ÿäº§ç¯å¢ƒå¯†é’¥ç®¡ç†**:
```yaml
# config/production.yaml
encryption:
  provider: "aws-kms"  # or "vault", "gcp-kms"
  key_id: "arn:aws:kms:us-east-1:123456789012:key/abc-123"
  rotation_days: 90
  backup_enabled: true
  
jwt:
  secret_provider: "env"  # or "vault"
  secret_key: "${JWT_SECRET}"  # from environment
  token_expiry_hours: 1
  refresh_expiry_days: 7

database:
  encryption_at_rest: true
  ssl_mode: "require"
  cert_path: "/etc/ssl/certs/db.crt"
```

**å¯†é’¥è½®æ¢æµç¨‹**:
```
1. ç”Ÿæˆæ–°å¯†é’¥ (Key V2)
   â†“
2. éƒ¨ç½²æ”¯æŒæ–°æ—§å¯†é’¥çš„ç‰ˆæœ¬
   â†“
3. é€æ­¥è¿ç§»æ•°æ® (V1 â†’ V2 åŠ å¯†)
   â†“
4. éªŒè¯æ‰€æœ‰æ•°æ®å·²è¿ç§»
   â†“
5. ç§»é™¤æ—§å¯†é’¥æ”¯æŒ (Key V1)
   â†“
6. å®‰å…¨é”€æ¯æ—§å¯†é’¥
```

---

### 5ï¸âƒ£ [401 é”™è¯¯è¯Šæ–­](./AUTH_401_DIAGNOSTIC_GUIDE.md) â­
**æ—¥æœŸ**: 2025-12-04  
**é€‚åˆ**: å‰ç«¯å·¥ç¨‹å¸ˆã€QAã€DevOps

**æ ¸å¿ƒå†…å®¹**:
- ğŸ› **å¸¸è§åŸå› ** - Token è¿‡æœŸã€æ ¼å¼é”™è¯¯ã€æœªç™»å½•
- ğŸ” **è¯Šæ–­æ­¥éª¤** - é€æ­¥æ’æŸ¥ 401 é”™è¯¯
- ğŸ› ï¸ **ä¿®å¤æ–¹æ¡ˆ** - Token åˆ·æ–°ã€é‡æ–°ç™»å½•
- ğŸ“ **æœ€ä½³å®è·µ** - å¦‚ä½•é¿å… 401 é”™è¯¯
- ğŸ§ª **æµ‹è¯•ç”¨ä¾‹** - éªŒè¯è®¤è¯æµç¨‹

**401 é”™è¯¯åˆ†ç±»**:
| é”™è¯¯åŸå›  | ç—‡çŠ¶ | è§£å†³æ–¹æ¡ˆ |
|---------|------|----------|
| **Token è¿‡æœŸ** | 1 å°æ—¶å API è¿”å› 401 | å®ç° Token åˆ·æ–°æœºåˆ¶ |
| **Token æ ¼å¼é”™è¯¯** | å§‹ç»ˆè¿”å› 401 | æ£€æŸ¥ `Authorization: Bearer <token>` |
| **æœªç™»å½•** | æ²¡æœ‰ Token | é‡å®šå‘åˆ°ç™»å½•é¡µ |
| **Token æ— æ•ˆ** | JWT éªŒè¯å¤±è´¥ | æ¸…é™¤ Tokenï¼Œé‡æ–°ç™»å½• |
| **æƒé™ä¸è¶³** | æœ‰ Token ä½†æ— æƒé™ | æ£€æŸ¥ç”¨æˆ·è§’è‰² (403) |

**è¯Šæ–­è„šæœ¬**:
```bash
# 1. æ£€æŸ¥ Token æ ¼å¼
TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
echo "$TOKEN" | base64 -d 2>/dev/null && echo "âœ… Valid Base64" || echo "âŒ Invalid"

# 2. æµ‹è¯• API
curl -H "Authorization: Bearer $TOKEN" \
    https://<your-backend-host>/api/v1/wallets

# 3. æ£€æŸ¥ Token è¿‡æœŸ
jwt decode "$TOKEN" | jq .exp
```

**å‰ç«¯ä¿®å¤**:
```rust
// Token åˆ·æ–°æ‹¦æˆªå™¨
impl ApiClient {
    async fn request<T>(&self, req: Request) -> Result<T> {
        let mut response = req.send().await?;
        
        // æ£€æµ‹ 401 é”™è¯¯
        if response.status() == 401 {
            // å°è¯•åˆ·æ–° Token
            if let Ok(new_token) = self.refresh_token().await {
                self.set_token(new_token);
                // é‡è¯•åŸè¯·æ±‚
                response = req.send().await?;
            } else {
                // åˆ·æ–°å¤±è´¥ï¼Œè·³è½¬ç™»å½•
                navigate_to("/login");
            }
        }
        
        response.json().await
    }
}
```

---

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### å‰ç«¯å®‰å…¨æ¸…å•
- [x] ç§é’¥åªå­˜å‚¨åœ¨ IndexedDBï¼Œä½¿ç”¨ AES-256-GCM åŠ å¯†
- [x] ä½¿ç”¨ Argon2id ä»ç”¨æˆ·å¯†ç æ´¾ç”ŸåŠ å¯†å¯†é’¥
- [x] æ¯ä¸ªé’±åŒ…ä½¿ç”¨å”¯ä¸€çš„ç›å€¼å’Œ IV
- [x] å®ç°è‡ªåŠ¨ Token åˆ·æ–°æœºåˆ¶
- [x] HTTPS Only (ç¦ç”¨ HTTP)
- [x] Content Security Policy (CSP)
- [x] ç¦æ­¢åœ¨ console.log è¾“å‡ºæ•æ„Ÿä¿¡æ¯
- [x] å®ç°é˜²é‡æ”¾æ”»å‡»æœºåˆ¶
- [x] XSS é˜²æŠ¤ (Dioxus è‡ªåŠ¨è½¬ä¹‰)
- [x] CSRF ä¿æŠ¤ (SameSite Cookie)

### åç«¯å®‰å…¨æ¸…å•
- [x] æ°¸è¿œä¸å­˜å‚¨ç§é’¥å’ŒåŠ©è®°è¯
- [x] ä½¿ç”¨ JWT è®¤è¯ (1 å°æ—¶è¿‡æœŸ)
- [x] å®ç° Rate Limiting (100 req/min)
- [x] è¾“å…¥éªŒè¯ï¼ˆæ‰€æœ‰ API å‚æ•°ï¼‰
- [x] SQL æ³¨å…¥é˜²æŠ¤ (å‚æ•°åŒ–æŸ¥è¯¢)
- [x] å®¡è®¡æ—¥å¿—ï¼ˆæ‰€æœ‰å…³é”®æ“ä½œï¼‰
- [x] æ•°æ®åº“è¿æ¥åŠ å¯† (TLS)
- [x] å®šæœŸå®‰å…¨æ‰«æ (OWASP Top 10)
- [x] ä¾èµ–é¡¹æ¼æ´æ‰«æ (cargo audit)
- [x] ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HSM/KMS

---

## ğŸ“Š å®‰å…¨æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å½“å‰çŠ¶æ€ |
|------|------|----------|
| **å¯†ç å¼ºåº¦** | Argon2id (64MB, 3 iter) | âœ… è¾¾æ ‡ |
| **Token è¿‡æœŸ** | 1 hour | âœ… å·²å®ç° |
| **åŠ å¯†ç®—æ³•** | AES-256-GCM | âœ… å·²å®ç° |
| **å¯†é’¥é•¿åº¦** | 256 bits | âœ… è¾¾æ ‡ |
| **HTTPS** | TLS 1.3 | âœ… å¼ºåˆ¶å¯ç”¨ |
| **å®¡è®¡è¦†ç›–ç‡** | 100% å…³é”®æ“ä½œ | ğŸ”„ 95% |
| **æ¼æ´æ‰«æ** | æ¯å‘¨ | âœ… è‡ªåŠ¨åŒ– |

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **ç³»ç»Ÿæ¶æ„**: [01-architecture/01-system-architecture.md](../01-architecture/01-system-architecture.md)
- **æ•°æ®åˆ†ç¦»**: [01-architecture/02-data-separation-model.md](../01-architecture/02-data-separation-model.md)
- **API è®¾è®¡**: [03-api-design/02-frontend-api-layer.md](../03-api-design/02-frontend-api-layer.md)
- **é”™è¯¯å¤„ç†**: [03-api-design/03-error-handling.md](../03-api-design/03-error-handling.md)
- **ç”Ÿäº§éƒ¨ç½²**: [06-production/05-deployment-guide.md](../06-production/05-deployment-guide.md)

---

**æœ€åæ›´æ–°**: 2025-12-06  
**ç»´æŠ¤è€…**: Security Team  
**å®¡æŸ¥è€…**: CISO, Security Architect
